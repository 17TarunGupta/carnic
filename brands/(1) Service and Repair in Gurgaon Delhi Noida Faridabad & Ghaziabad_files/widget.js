!function(c){var s=void 0,l=void 0,r="https://widget.fuguchat.com",u="https://chat.fuguchat.com";isComplete=!1;var p,m="",a=!1,f={appSecretKey:"kenwfdhwoiujGSDIUUHU82E8HD98",collapseType:"hide",showData:!1,address:{city:"Chandigarh",country:"India"},customAttributes:{}},o=document.title,n=!0;function i(){c.onblur=function(){!1,L.ActiveInactiveTabEvent({type:"ActiveInactiveTabEvent",data:{isActive:!1}},r)},c.onfocus=function(){!0,L.ActiveInactiveTabEvent({type:"ActiveInactiveTabEvent",data:{isActive:!0}},r)}}function d(t){"function"==typeof t.callback&&(m=t.callback,t.callback=""),f=t}function g(t,e){try{"complete"===document.readyState?(t&&0<Object.keys(t).length&&d(t),o=document.title,t.showHelpChannel=n,i(),C(t),s.addEventListener("load",x.load,!1),c.addEventListener("message",x.message,!1)):document.onreadystatechange=function(){"complete"===document.readyState&&(t.showHelpChannel=n,g(t,e))}}catch(t){console.error("Widget exception: ",t)}void 0!==e&&1!=e||(p=t)}function v(e){e.data.body&&e.data.channel_id&&("Notification"in c?"granted"===Notification.permission?h(e):"denied"===Notification.permission&&"default"!==Notification.permission||function(){if(!c.Notification||!Notification.requestPermission)return!1;if("granted"==Notification.permission)throw new Error("You must only call this *before* calling Notification.requestPermission(), otherwise this feature detect would bug the user with an actual notification!");try{new Notification("")}catch(t){if("TypeError"==t.name)return!1}return!0}()&&!a&&Notification.requestPermission(function(t){a=!0,"granted"===t&&h(e)}):console.log("This browser does not support desktop notification"))}function h(e){var t=e.data.title,a={body:e.data.body,icon:e.data.icon,data:{url:r+"/chat/"+e.data.channel_id,channel_id:e.data.channel_id}};notification=new Notification(t,a),notification.onclick=function(t){L.FayeNotification({channel_id:e.data.channel_id},r),c.focus(),notification.close(),document.title=y(e.data.unread_count)}}function y(t){return(0<t?"("+t+") ":"")+o}function t(t){T(),document.title=o,g(t,!1)}function C(t){if(s)"function"==typeof m?(m.call(this),m=""):t.collapseType&&"hide"==t.collapseType&&(L.Expand({type:"Expand",data:{}},r),L.Expand({type:"Expand",data:{}},c.location.origin));else{var e=document.createElement("iframe");e.id="iframe_fuguWidgetContent",e.setAttribute("allow","microphone; camera"),e.classList.add("collapsed"),t.collapseType&&"hide"==t.collapseType&&(e.dataset.collapsedHidden="true"),e.src=r,e.style.borderRadius="6px",e.border=0,document.body.appendChild(e),s=e}}function e(t){var e=["<link rel='stylesheet' href='"+u+"/public/build/css/circularIframe.css' />"],a=' <div id="fuguLauncherContainer" class="fugu-launcher hidden" onclick="toggle()"><p id="totalMessageCount" class="hidden" ></p><div class="fugu-launcher-open-icon defaultBackgroundColor"><img class="chat-icon" src="'+u+'/public/img/chat-icon-1.svg"/> <img class="cancel-icon" src="'+u+'/public/img/cancelbtn.svg" /></div></div >',o="<head>"+["<script async defer src='"+u+"/public/js/circularIframe.js' type='text/javascript' ><\/script>"].join("")+e.join("")+"</head><body class='collapsed'>"+a+"</body>",n=document.createElement("iframe");n.id="iframe_fuguWidget",n.classList.add("collapsed"),document.body.appendChild(n),n.contentWindow.document.open(),n.contentWindow.document.write(o),n.contentWindow.document.close(),l=n,t.collapseType&&"hide"==t.collapseType&&(n.dataset.collapsedHidden="true"),t.driverInfo&&Object.keys(t.driverInfo).length&&(l.style.width="0px",l.style.height="0px",l.style.position="fixed",l.style.left="-500px",l.style.top="-500px")}i();var E,b,x={load:function(t){console.log("Loaded Hippo Customer Widget Iframe",t),L.Initialize(f,r),e(f)},loadReseller:function(t){console.log("loaded iframe",t),L.InitializeReseller(f,r),e(f)},message:function(t){if(t.origin==r)switch(t.data.type){case"Collapse":s.classList.add("collapsed"),l.classList.add("collapsed"),l.classList.remove("notification-1"),s.classList.remove("notification-1"),L.Collapse({type:"Collapse",data:t.data},c.location.origin),(e=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))&&(s.classList.remove("ios-fix"),S());break;case"Expand":s.classList.remove("collapsed","notification-1"),l.classList.remove("collapsed","notification-1"),L.Expand(t.data,c.location.origin),(e=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))&&k();break;case"Config":L.Config(t.data,r);break;case"Notification":t.data.data.count&&!t.data.data.hideNotification&&(s.classList.add("notification-1"),l.classList.add("notification-1")),t.data.data.doNotUpdateOnTitleBar||(document.title=y(t.data.data.count)),L.Notification(t.data,r),L.unreadCountChanged(t);break;case"Shutdown":s.classList.add("collapsed"),l.classList.add("collapsed"),L.Collapse({type:"Collapse",data:t.data},c.location.origin),T(),p&&"hide"!=p.collapseType&&!p.hideWidget&&g(p,!0);break;case"SetupComplete":isComplete=!0,"function"==typeof m?(m.call(this),m=""):f.collapseType&&"hide"==f.collapseType&&(L.Expand({type:"Expand",data:{}},r),L.Expand({type:"Expand",data:{}},c.location.origin)),L.FuguReady();break;case"IosFix":var e=!!navigator.platform&&/iPhone|iPod/.test(navigator.platform),a=!!navigator.platform&&/iPad/.test(navigator.platform);e?t.data.data&&(void 0!==c.pageYOffset?c.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop):a&&(t.data.data?P():S());break;case"Image":d=t.data.data,console.log("image is clicked"),function(t){var e=document.createElement("div");e.id="imageContainer",e.onwheel=function(t){t.preventDefault(),t.stopPropagation()},e.ontouchmove=N;var a=document.createElement("button");a.id="closeimg",a.onclick=function(){document.body.removeChild(e)};var o=document.createTextNode("Close"),n=document.createElement("img");n.id="closeicon",n.src=u+"/public/img/close-btn.svg";var i=document.createElement("a");i.blank="target",i.id="downloadAnchor";var d=document.createTextNode("Download"),c=document.createElement("img");c.id="imageDownload",c.src=u+"/public/img/download.svg",i.appendChild(c),i.href=t;var s=document.createElement("div");s.id="imagediv";var l=document.createElement("img");l.id="WidgetImageMessage",l.src=t,s.appendChild(l),e.appendChild(s),a.appendChild(n),a.appendChild(o),i.appendChild(d),e.appendChild(a),e.appendChild(i),document.body.appendChild(e)}(d);break;case"FayeNotification":(i=t.data).data.agent_name&&(document.title=i.data.agent_name+" says"),setTimeout(function(){document.title=y(i.data.unread_count)},1e3),v(t.data);break;case"PaymentMessage":L.PaymentMessage(t.data);break;case"TotalPaymentAmountMessage":L.TotalPaymentAmountMessage(t.data);case"saveDeviceIDToLocal":localStorage.hippoWidget=JSON.stringify(t.data.data);break;case"addClassToIframeContent":try{s.classList.add(t.data.data.toString())}catch(t){console.log(t)}break;case"removeClassFromIframeContent":try{s.classList.remove(t.data.data.toString())}catch(t){console.log(t)}}else if(t.origin==c.location.origin)switch(t.data.type){case"Collapse":L.Collapse(t.data,r),s&&s.classList.add("collapsed"),l&&l.classList.add("collapsed");var o=new CustomEvent("fuguWidgetCollapse",{});document.dispatchEvent(o);break;case"Expand":L.Expand(t.data,r),s&&s.classList.remove("collapsed","notification-1"),l&&l.classList.remove("collapsed","notification-1");var n=new CustomEvent("hippoWidgetExpand",{});document.dispatchEvent(n),(e=!!navigator.platform&&/iPhone|iPod/.test(navigator.platform))&&k();break;case"ConfigCompleted":L.ConfigCompleted(t.data,r)}var i,d}},L={Initialize:function(t,e){w("Init",t,e)},InitializeReseller:function(t,e){w("InitReseller",t,e)},Expand:function(t,e){w("Expand",t,e)},Collapse:function(t,e){w("Collapse",t,e)},Config:function(t,e){w("Config",t,c.location.origin)},Notification:function(t,e){w("Notification",t,c.location.origin)},Shutdown:function(t,e){w("Shutdown",t,e)},StartConversation:function(t,e){w("StartConversation",t,e)},StartConversationFromAgent:function(t,e){w("StartConversationFromAgent",t,e)},StartPeerToPeerConversation:function(t,e){w("StartPeerToPeerConversation",t,e)},ConfigCompleted:function(t,e){w("ConfigCompleted",t,e)},ShowImage:function(t,e){w("ShowImage",t,e)},Blur:function(t,e){w("Blur",t,e)},FuguReady:function(){var t=new CustomEvent("fuguWidgetReady",{});document.dispatchEvent(t)},BotMessage:function(t,e){w("BotMessage",t,e)},unreadCountChanged:function(t){var e=new CustomEvent("notificationCount",{detail:{count:t.data.data.count||0}});document.dispatchEvent(e)},FayeNotification:function(t,e){w("FayeNotification",t,e)},ActiveInactiveTabEvent:function(t,e){w("ActiveInactiveTabEvent",t,e)},PaymentMessage:function(t){var e=new CustomEvent("paymentMessage",{detail:{button_info:t.data.button_info,message_data:t.data.message_data}});document.dispatchEvent(e)},TotalPaymentAmountMessage:function(t){var e=new CustomEvent("TotalPaymentAmountMessage",{detail:t.data});document.dispatchEvent(e)},UpdateLocalStorageData:function(t,e){w("UpdateLocalStorageData",t,e)}};function w(t,e,a){a==c.location.origin?l&&l.contentWindow.postMessage({type:t,data:e,parent_origin:c.location.origin,current_url:c.location.href,hostname:c.location.hostname},a):s&&s.contentWindow.postMessage({type:t,data:e,parent_origin:c.location.origin,current_url:c.location.href,hostname:c.location.hostname},a)}function T(){s&&s.remove(),l&&l.remove(),l=s=void 0}function I(t){L.Shutdown({hostname:c.location.hostname,hideWidget:!!t&&t.hideWidget},r),document.title=o,n=!1,localStorage.removeItem("f_uid_Id")}function k(){s.classList.add("ios-fix"),P()}function P(){l.classList.add("ipad-fix"),s.classList.add("ipad-fix");var t=document.createElement("div");t.id="ipadLayer",t.ontouchmove=_,t.onclick=W,t.ontouchstart=W,document.body.appendChild(t),document.getElementsByTagName("html")[0].classList.add("ipad-fix-html"),document.body.classList.add("ipad-fix-body")}function S(){l.classList.remove("ipad-fix"),s.classList.remove("ipad-fix");var t=document.getElementById("ipadLayer");document.body.removeChild(t),document.getElementsByTagName("html")[0].classList.remove("ipad-fix-html"),document.body.classList.remove("ipad-fix-body")}function N(t){t.preventDefault(),t.stopPropagation()}function W(t){document.activeElement.blur(),S(),L.Blur({type:"Blur",data:{}},r)}function _(t){N(t),document.activeElement.blur()}function A(){L.Expand({type:"Expand",data:{}},c.location.origin)}function M(){L.Collapse({type:"Collapse",data:{}},c.location.origin)}document.addEventListener("notificationCount",function(t){console.log(t)}),c.initHippo=g,c.updateHippo=t,c.logoutHippo=I,c.destroyHippoCustomerWidget=T,c.expandHippoWidget=A,c.collapseHippoWidget=M,c.startConversationFromAgent=function(t){isComplete&&(t.agentMessage&&0!=t.agentMessage.length&&""!=t.agentMessage[0].trim()?(s.classList.remove("collapsed","notification-1"),l.classList.remove("collapsed","notification-1"),L.Expand({type:"Expand",data:{}},c.location.origin),L.StartConversationFromAgent({data:t,origin:r},r)):console.error("Empty message string provided! "))},c.fuguInit=g,c.fuguInitReseller=function t(e,a){try{"complete"===document.readyState?(e&&0<Object.keys(e).length&&d(e),i(),C(e),s.addEventListener("load",x.loadReseller,!1),c.addEventListener("message",x.message,!1)):document.onreadystatechange=function(){"complete"===document.readyState&&t(e,a)}}catch(t){console.error("Widget exception: ",t)}void 0!==a&&1!=a||(p=e)},c.fuguUpdate=t,c.shutDownFugu=I,c.startConversation=function(t){isComplete&&(s.classList.remove("collapsed","notification-1"),l.classList.remove("collapsed","notification-1"),L.Expand({type:"Expand",data:{}},c.location.origin),L.StartConversation({data:t,origin:r},r))},c.startPeerToPeerConversation=function(t){isComplete&&(s.classList.remove("collapsed","notification-1"),l.classList.remove("collapsed","notification-1"),L.Expand({type:"Expand",data:{}},c.location.origin),L.StartPeerToPeerConversation({data:t,origin:r},r))},c.showConversationList=A,c.fuguWidget_Expand=A,c.fuguWidget_Collapse=M,c.fuguWidget_BotMessage=function(t){L.BotMessage(t,r)},c.fuguDestroyCustomerWidget=T,E=document.getElementsByTagName("head")[0],(b=document.createElement("link")).id="FuguWidgetIframe_css",b.rel="stylesheet",b.type="text/css",b.href=u+"/public/build/css/widget.css",b.media="all",E.appendChild(b)}(window);